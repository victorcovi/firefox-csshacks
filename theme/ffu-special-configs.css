/*///////////////////////////////////////////////////////////////////////////////////////\

FF Ultima:         https://github.com/soulhotel/FF-ULTIMA
File Desc:         Handle Configurations for Nightly, Autoconfig, ...
Wiki:              Todo

Autoconfig Configurations
  - Animate the Container label
  - Sidebar button
  - URL bar toggle button
  - urlbar input ONLY in the private
  - Reveal #urlbar
  - second sidebar compatibility
Nightly Configurations

\////////////////////////////////////////////////////////////////////////////////////////*/

/* Autoconfig Configurations -------------------------------------------------------------------------------- */

@media -moz-pref("ultima.enable.js.config") {

    /* Animate the Container label */
    #userContext-label {
        max-width: 0 !important;
        overflow: hidden;
        white-space: nowrap;
        transition: max-width 400ms ease-in-out 1s;
    }
    /* Label animation gating (restored) */
    #navigator-toolbox.state-collapsed:hover #urlbar-container #userContext-label,
    #navigator-toolbox.state-collapsed.state-hovering #urlbar-container #userContext-label,
    #navigator-toolbox.state-collapsed.state-force-expanded #urlbar-container #userContext-label,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container:hover #userContext-label {
        max-width: 200px !important;
        transition-delay: 0s;
    }
    /* Sidebar button states */
    #bmf-btn-sidebar.sb-collapsible .toolbarbutton-icon {
        fill: var(--uc-accent-color-2) !important;
    }
    /* URL bar toggle button states */
    #bmf-btn-urlhide.state-default {
    fill: var(--toolbar-color) !important;
    opacity: var(--toolbarbutton-disabled-opacity);
    }
    #bmf-btn-urlhide.state-simplified {
    fill: var(--uc-accent-color-2) !important;
    opacity: 1;
    }
    #bmf-btn-urlhide.state-private {
    fill: #d51f1f !important;
    opacity: 1;
    }
    /* Hide the urlbar input ONLY in the private state (button has .state-private) */
    #urlbar-container.urlbar-domain-only:has(#bmf-btn-urlhide.state-private) #urlbar-input {
    opacity: 0;
    transition: opacity 0.3s ease-out 1s;
    }
    #urlbar-container.urlbar-domain-only:has(#bmf-btn-urlhide.state-private) .urlbar-input-container {
    opacity: 0.3;
    transition: opacity 0.3s ease-out 1s;
    }
    /* Reveal #urlbar and its children only when navbar is effectively expanded */
    #navigator-toolbox.state-collapsed:hover #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #userContext-label,
    #navigator-toolbox.state-collapsed:hover #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #urlbar,
    #navigator-toolbox.state-collapsed:hover #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #urlbar-input,
    #navigator-toolbox.state-collapsed:hover #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) .urlbar-input-container,
    #navigator-toolbox.state-collapsed:hover #urlbar-container #urlbar,
    #navigator-toolbox.state-collapsed:hover #urlbar-container #urlbar-input,
    #navigator-toolbox.state-collapsed:hover #urlbar-container .urlbar-input-container,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #userContext-label,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #urlbar,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) #urlbar-input,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container.urlbar-domain-only:has(#urlbar[focused]) .urlbar-input-container,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container:hover #urlbar,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container:hover #urlbar-input,
    #navigator-toolbox:not(.state-collapsed) #urlbar-container:hover .urlbar-input-container {
    opacity: 1;
    transition: opacity 0.1s ease-in;
    }

    /* second sidebar compatibility */
    #sb2-wrapper {
        & #sb2-box {
            background-color: var(--toolbar-bgcolor) !important;
            border-width: 1px !important;
            z-index: 9 !important;
        }
        & #sb2-toolbar {
            background-color:  var(--toolbar-bgcolor) !important;
            margin-top: var(--space-xxsmall) !important;
        }
        & #sb2-main {
            padding: var(--space-xxsmall) var(--sb2-main-padding) var(--space-small) var(--space-xxsmall) !important;
        }
        &:has(#sb2-box[pinned="true"]:not([hidden])) #sb2-main {
            padding: var(--space-xxsmall) var(--sb2-main-padding) var(--space-small) var(--space-small) !important;
        }
        @media -moz-pref("ultima.spacing.compact") {
            /**/
        }
    }
    #main-window[lwtheme] {
        & #sb2-box {
            background-color: var(--toolbox-bgcolor) !important;
        }
        & #sb2-toolbar {
            background-color:  var(--toolbox-bgcolor) !important;
        }
    }
    #main-window[class="sb2-webpanels-window"] {
        &[lwtheme], &:not([lwtheme]) {
            #tabbrowser-tabpanels {
                border-radius: 0 !important;
                border: none !important;
            }

            #tabbrowser-tabpanels browser[type] {
                margin: 0 !important;
                border: 2px transparent solid !important;
            }
        }
    }
    #sb2-splitter {
        margin: 10px 0 !important;
    }
    #sb2-after-splitter {
        width: 1px !important;
    }

}

/* Nightly Configurations (quick patches specific to nightly) ----------------------------------------------- */

@media -moz-pref("ultima.enable.nightly.config") {


    
}

/* Temporary solutions no config ----------------------------------------------------------------------------- */

@media not -moz-pref("ultima.enable.js.config") {
    
    #navigator-toolbox[movingtab] > #nav-bar {
      pointer-events: auto !important;
    }
    /* these are defaults set by firefox source content-area.css Line 7-13
    https://searchfox.org/mozilla-central/source/browser/themes/shared/tabbrowser/content-area.css#7-13 */
    @media (-moz-content-prefers-color-scheme: light) {
        :root {--tabpanel-background-color: #f9f9fb !important;}
    }
    @media (-moz-content-prefers-color-scheme: dark) {
        :root {--tabpanel-background-color: #2b2a33 !important;}
    }
    /*
    transparency
    #tabbrowser-tabs[orient="vertical"][overflow]::after {
      content: none !important;
    }
    */
    /* window title in menu bar */
    :root:not([sizemode="fullscreen"]):has(#toolbar-menubar:not([inactive="true"])) > head {
        display: block;
        position: fixed; top: 12px; right: 140px;
        width: calc(100vw - 285px);
        text-align: center;
        pointer-events: none;
        text-overflow: ellipsis;
        overflow-x: hidden;
        z-index: 1;
        & title {
            display: contents;
            max-width: 50vw;
            white-space: nowrap;
        }
        & * {
            display: none;
        }
    }
    #inputs, .extensions {
        --sidebar-box-border: var(--sidebar-box-border-width) solid color-mix(in srgb, var(--sidebar-box-border-color) 10%, transparent) !important;
    }
    moz-card {
        background-color: color-mix(in srgb, var(--uc-layered-background) 95%, black) !important;
    }
    
}

  

/* //
- discontinue window title in menu bar, unconsistent across OS's
- need to test pointer events unforced on windows, hopefully this issue is finally corrected in firefox
- follow progress on tab split viewing https://bugzilla.mozilla.org/show_bug.cgi?id=1980370 tab-split-view-wrapper, *[split-view-first], *[split-view-second]
*/